
<script>
import { createConsumer } from "@rails/actioncable";

document.addEventListener("DOMContentLoaded", function () {
  window.scrollTo(0, document.body.scrollHeight);
  
  # const consumer = createConsumer();
  
  # # consumer.subscriptions.create("MessagesChannel", {
  # #   received(data) {
  # #     console.log("Got a message here!")
  # #     // Handle incoming broadcasted data
  # #     const messagesContainer = document.getElementById("messages");
  # #     const messageElement = document.createElement("p");
  # #     messageElement.innerText = `${data.body} (at ${data.created_at})`;
  # #     messagesContainer.appendChild(messageElement);
  # #     },
  # #     });
  

  });
  
  
  
  
  
      
      </script>
      
      <% content_for :title, "New message" %>
      
      <div id="messages">
  <% @messages.each do |message| %>
    <div style="margin-bottom:20px; background: turquoise; padding: 5px">
      <small style="padding:0">
        <%= message.created_at.in_time_zone("Stockholm").strftime("%B %d, %Y %I:%M %p") %>
      </small>
      <p style="padding-left: 5px">
        <%= message.body %>
      </p>
    </div>
  <% end %>
</div>

<%= render "form", message: @message %>

<br>

<div>
  <%= link_to "Back to messages", messages_path %>
</div>
